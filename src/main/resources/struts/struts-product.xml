<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.1//EN"
    "http://struts.apache.org/dtds/struts-2.1.dtd">

<struts>
    <!-- 
        商品相關功能的封裝 package：
        命名空間設為 "/product"，頁面路徑會以 /product 開頭
        繼承自 default，具備基本功能
    -->
    <package name="product" extends="default" namespace="/product">

        <!-- 
            自訂攔截器堆疊：處理 model 驅動、檔案上傳等基本功能
        -->
        <interceptors>
            <interceptor-stack name="productStack">
                <interceptor-ref name="modelDrivenStack" />
                <interceptor-ref name="fileUpload" />
                 <interceptor-ref name="defaultStack"/>
            </interceptor-stack>
        </interceptors>

        <!-- 設定當前 package 使用自訂的攔截器堆疊 -->
        <default-interceptor-ref name="productStack" />
        <!-- 
            商品查詢與列表頁面：
             Action 名稱為 "search"
             對應的處理類別為 com.example.action.ProductAction
             預設執行 execute() 方法
        -->
        <action name="search" class="com.example.action.ProductAction" method="execute">
            <!-- 查詢成功，顯示商品 -->
            <result name="success">/user/product.jsp</result>
            <result name="error">/user/product.jsp</result>
        </action>

        

        <!-- 
            加入購物車功能：
             Action 名稱為 "addToCart"
             方法 addToCart() 實作加入購物車邏輯
             執行完後重新導向回商品列表或購物車頁
        -->
        <action name="addToCart" class="com.example.action.ProductAction" method="addToCart">
            <result name="success" type="redirect">/cart.jsp</result>
        </action>
        
        <!-- AJAX 請求要回傳 fragment -->
        <action name="detail" class="com.example.action.ProductAction" method="detail">
    		<result name="success">/WEB-INF/views/product-detail.jsp</result>
    		<result name="ajax">/WEB-INF/views/product-detail.jsp</result>
   			<result name="error">/error.jsp</result>
		</action>

    </package>
</struts>
